\documentclass{article}
\documentclass{bar}
\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[fleqn]{amsmath}
\usepackage{titling}
\usepackage{graphicx,wrapfig,lipsum}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{mathtools}
\usepackage[font=small,labelsep=none]{caption}

\setlength{\droptitle}{-10em}
\setlength\parindent{0pt}

\title{Project 1 - FYS3150}\vspace{-3ex}
\author{Emil Helland Broll, Benedicte Allum Pedersen,\\ Fredrik Oftedal Forr}
\date{\vspace{-5ex}}

\begin{document}
\maketitle

\subsection*{Introduction}

Poisson's equation is a classical equation from electromagnetism, in three dimensions the equation is:

\begin{equation*}
\nabla^2 \Phi = -4\pi \rho (\mathbf{r}).
\end{equation*}

\noindent where $\Phi$ is the electrostatic potential generated by a localized charge distribution $\rho (\mathbf{r})$. If $\Phi$ and $\rho (\mathbf{r})$ are spherical symmetrical, and we do the substitution $\Phi(r)= \phi(r)/r$, the equation simplifies to:

\begin{equation*}
\frac{d^2\phi}{dr^2}= -4\pi r\rho(r).
\end{equation*}

If we let $f = -4\pi r \rho (\mathbf{r})$, and by let $\phi\rightarrow u$ and
$r\rightarrow x$, the general one-dimensional Poisson equation will read:

\begin{equation*}
-u''(x) = f(x).
\end{equation*}

\subsection*{Project 1a)}

\noindent We have solved the one-dimensional Poisson equation with Dirichlet boundary conditions and by rewriting it as a set of linear equations.

\noindent We let the discretized approximation to $u$ be defined as $v_i$. The second derivative of $u$ is then defined as:

\[
&-\frac{v_{i+1}+v_{i-1}-2v_i}{h^2} = f_i
\]

where $h$ is the step length and is defined as $h=1/(n+1)$ and where $f_i = f(x_i)$.

We can rewrite this equation to a set of linear equations like this:

\begin{flalign*}
   &-\frac{v_{i+1}+v_{i-1}-2v_i}{h^2} = f_i\\
   &-(v_{i+1}+v_{i-1}-2v_i) = f_ih^2\\
   &2v_i -v_{i+1}-v_{i-1}=f_ih^2
\end{flalign*}
Wich expands to
\begin{flalign*}
  2v_1 - v_0 - v_2 &= f_1h^2\\
  2v_2 - v_1 - v_2 &= f_2h^2\\
  &\vdots\\
  2v_n - v_{n-1} - v_n+1 &= f_3h^2\\
\end{flalign*}
The boundary conditions give us $v_{n+1}=u(1)=0$ and $v_0=u(0)=0$. We also introduce $f_ih^2 = g_i$. We can then write this expression as
\begin{flalign*}
  \begin{bmatrix}
    2 & -1 & 0 &\dots & 0 & 0\\
    -1 & 2 & -1 & \dots & 0 & 0\\
    0 & -1 & 2 & \dots & 0 & 0 \\
    \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
    0 & 0 & 0 &\dots& 2 & -1\\
    0 & 0 & 0 &\dots& -1 & 2
  \end{bmatrix}
  \begin{bmatrix}
    v_1\\
    v_2\\
    v_3\\
    \vdots\\
    v_{n-1}\\
    v_n
  \end{bmatrix} =
  \begin{bmatrix}
    g_1\\
    g_2\\
    g_3\\
    \vdots\\
    g_{n-1}\\
    g_n
  \end{bmatrix}
\end{flalign*}


\subsection*{Project 1b)}


We rewrite our matrix A in terms of one-dimensional vectors $\textit{a, b, c}$ of length 1 : $n$;
\begin{flalign*}
  \mathbf{A}=\begin{bmatrix}
    b_1 & c_1 & 0 &\dots & \dots & 0 \\
    a_1 & b_2 & c_2 & \dots & \dots & 0 \\
    0 & a_2 & b_3 & c_3 & \dots \dots & 0  \\
    \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
    0 & 0 &\dots& a_{n-2} & b_{n-1} & c_{n-1}\\
    0 & 0 &\dots& \dots & a_{n-1} & b_{n}
  \end{bmatrix}
\end{flalign*}

The algorithm for the forward substitution will then be as followed.
\begin{flalign}
  &b_1v_1 + c_1v_2 = \tilde{g}_1\\
  &a_1v_1 + b_2v_2 + c_2v_3 = \tilde{g}_2\\
  &a_2v_2 + b_3v_3 + c_3v_4 = \tilde{g}_3\\
  &\vdots \notag\\
  &a_{n-1}v_{n-1} + a_nv_n = \tilde{g}_n
\end{flalign}
Multiplying equation (1) with $\frac{a_1}{b_1}$, wich gives us.\\
\begin{center}
  $a_1v_1 + \frac{a_1c_1}{b_1}v_2 = \tilde{g_1}\frac{a_1}{b_1} $\\
\end{center}
\vspace{0.3cm}

\noindent We then set equation (2) minus equation (1)\\
\begin{flalign*}
  a_1v_1- a_1v_1 + b_2v_2 - \frac{a_1c_1}{b_1}v_2 + c_2v_3 &= g_2 - g_1\frac{a_1}{b_1}\\
  \left(b_2 - \frac{a_1c_1}{b_1} \right)v_2 + c_2v_3 &= g_2 - g_1\frac{a_1}{b_1}\\
  \tilde{b}_2v_2 +c_2v_3 &= \tilde{g}_2
\end{flalign*}

\noindent The general expressions is
\begin{flalign*}
  \begin{aligned}
    \tilde{b}_i = b_i - \frac{c_{i-1}a_{i-1}}{\tilde{b}_{i-1}}
  \end{aligned},
  \qquad \qquad
  \begin{aligned}
    \tilde{g}_i = g_i - g_{i-1}\frac{a_{i-1}}{\tilde{b}_{i-1}}
  \end{aligned}
\end{flalign*}
Where $\tilde{b}_1 = b_1$ and $\tilde{g}_1 = g_1$\\

\noindent We can then use this to compute the vector $\hat{u}$. This has the general solution\\
\begin{flalign*}
  v_i = \frac{\tilde{g}_i - a_i v_{i+a}}{\tilde{b}_i}
\end{flalign*}


We have made a code for the algortihm and solved the problem for matrices of the size 10 x 10, 100 x 100 and 1000 x 1000. To reduce the problem and to save memory we only use the vectors $a, b$ and $c$, since the rest of the matrix only consist of zeros. Then the number of floating points are $O(9n)$.

\subsection*{Project 1c)}

Our matrix now have identical elements along the diagonal and identical values for the non diagonal elements, it will look like this:

\begin{flalign*}
  \begin{bmatrix}
    b & a & 0 &\dots & 0 & 0\\
    a & b & a & \dots & 0 & 0\\
    0 & a & b &  \dots & 0 & 0 \\
    \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
    0 & 0 & 0 &\dots& b & a\\
    0 & 0 & 0 &\dots& a & b
  \end{bmatrix}
\end{flalign*}

\noindent We develope the algortihm for the forward substitution in the same way as earlier, so the algorithm will be as followed. Here $\tilde{b}_1 = b = 2$ and the algorithm will run with i starting from 2 and going up to n.

\begin{flalign*}
  \begin{aligned}
    \tilde{b_i} &= b - \frac{a^2}{b + (i-2)} = 2 - \frac{a^2}{i}
  \end{aligned},
  \qquad \qquad
  \begin{aligned}
    \tilde{g_i} = g_i - \frac{a}{\tilde{b}_{i-1}}g_{i-1} \\
  \end{aligned}
\end{flalign*}

\noindent where $\tilde{b}_1 = b$ and $\tilde{g}_1 = g$.

\vspace{0.2cm}

\noindent Likewise the algorithm for the bacward substitution will be:

\begin{flalign*}
  \begin{aligned}
    u_i = \frac{\tilde{g}_i - a}{\tilde{b}_i} v_{i+1}
  \end{aligned},
\end{flalign*}




\end{document}
