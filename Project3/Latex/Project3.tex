\documentclass{article}
\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[fleqn]{amsmath}
\usepackage{titling}
\usepackage{graphicx,wrapfig,lipsum}
\usepackage{amssymb}
\usepackage{listings}
\usepackage[font=small,labelsep=none]{caption}
\usepackage{hyperref}
\usepackage{caption}

\setlength{\droptitle}{-10em}
\setlength\parindent{0pt}

\title{Project 3}\vspace{-3ex}
\author{Benedicte Allum Pedersen, Emil Heland Broll\\ Fredrik Oftedal Forr}
\date{\vspace{-5ex}}

\begin{document}
\maketitle

\section*{Abstract}


\section*{Introduction}
In this report there were given a brief rundown on different numerical integration methods. The methods that have been used is Gauss-Legendre and Gauss-Laguerre quadrature as well as Monte Carlo integration. There will be adjustments to these to show the different strengths of the methods. Under this paragraph you can find the method on how the program works, results from the program, discussion where we analyze the results and ending with a conclusion. At the end of this report you will find an appendix where additional data are located.\\

The integral we have worked with is a six-dimensional integral which determines the ground state correlation energy between two electrons in a helium atom.\\

The single-particle wave function for an electron $i$ in the $1s$ state in a hydrogen atom is as followed:

\begin{flalign*}
  \psi_{1s}(\textbf{r}_i)= e^{- \alpha r_i}
\end{flalign*}

where $\textbf{r}_i = x_i \textbf{e}_x + y_i \textbf{e}_y + z_i \textbf{e}_z +$, and the value of $r_i$ is given by:

\begin{flalign*}
  r_i = \sqrt{x_i^2 + y_i^2 +z_i^2}
\end{flalign*}

We set $\alpha = 2$ which corresponds to the charge of the helium atom, Z = 2. We assume that the wave function for each electron in the helium atom can be modelled like the single-particle wavefunction above. The wavefunction for two electron is then given bye the product of two single-particle wavefunctions:

\begin{flalign*}
  \Psi(\textbf{r}_1, \textbf{r}_2) = e^{-\alpha(r_1 + r_2)}
\end{flalign*}

We need to solve the intergral for the expectation value of the correlation energy between two electrons:

\begin{flalign*}
  \left<\frac{1}{|\textbf{r}_1 - \textbf{r}_2|}\right> = \int_{-\infty}^{\infty} d\textbf{r}_1 d\textbf{r}_2 e^{-\alpha(r_1 + r_2)} \frac{1}{|\textbf{r}_1 - \textbf{r}_2|}
\end{flalign*}



\section*{Method}
In this problem there have been used c++ as programming language and mainly a variety of functions to solve the problem.

\subsection*{Gaussian Quadrature}
To compute the integral numerically we approximate the integral:

\begin{flalign*}
  I = \int_{a}^{b} f(x) dx = \int_{a}^{b} W(x)g(x) dx \approx \sum_{i=1}^{N} \omega_i f(x_i)
\end{flalign*}

Unlike other more basic methods for numerical integrations where the mesh points $x_i$ are equidistantly spaced, the mesh points in the gaussian quadrature are not equidistantly spaced. In the sum above $w_i$ correpsonds to the weights. Gaussian quadrature uses som orthonogonal polynomials, Legendre and Laguerre, to obtain the mesh points and weights.\\

To obtain the value of the integral by using Gauss-Legendre quadrature, we have to set up the mesh points and weights that corresponds to some finite integrations limits [a, b]. To set up the mesh points and weights we haved used the function $gauleg$ from Morten's \href{https://github.com/CompPhysics/ComputationalPhysics/blob/master/doc/Projects/2019/Project3/CodeExamples/exampleprogram.cpp}{exampleprogram.cpp}.\\

While the Legendre polynomials are defined for $x \in [-1, 1]$ the Laguarre polynomials are defined for $x \in [0, \infty)$. We rewrite the integral and change to spherical coordinates.

\begin{falign*}
  d\textbf{r}_1d\textbf{r}_2 = r_1^2dr_1r_2^2dr_2dcos(\theta_1)dcos(\theta_2)d\phi_1d\phi_2
\end{falign*}

So the integral becomes:\\

\begin{flalign*}
  I = \int_0^\infty r_1^2dr_1 \int_0^\infty r_2^2dr_2 \int_0^\pi dcos(\theta_1) \int_0^\pi dcos(\theta_2) \int_0^{2\pi} d\phi_1 \int_0^{2\pi} d\phi_2 \frac{e^{-2\alpha(r_1+r_2)}}{r_{12}}
\end{flalign*}

where

\begin{flalign*}
  \frac{1}{r_{12}} = \frac{}{\sqrt{r_1^2 + r_2^2 - 2r_1r_2cos(\beta)}}
\end{flalign*}

with

\begin{flalign*}
  cos(\beta) = cos(\theta_1)cos(\theta_2) + sin(\theta_1)sin(\theta_2)cos(\phi_1 - \phi_2)
\end{flalign*}

We perform the integration over $\theta \in [0, \pi]$, $\phi \in [0, 2\pi]$ and $r \in [0, \infty)$. To calculate the mesh points and weight for the angles we use the same function as for the Gauss-Legendre quadrature. To calculate the mesh points and weights corresponding to r we use Morten's function \href{https://github.com/CompPhysics/ComputationalPhysics/blob/master/doc/Projects/2019/Project3/CodeExamples/gauss-laguerre.cpp}{gauss_laguerre.cpp}.

\subsection*{Monte Carlo integration}
Monte Carlo integration allows us to make a good approximation to

\section*{Results}

\section*{Discussion}


\section*{Conclution}

3a)

N=15, $\lambda = 2$ gauss_legendre= 0.19947

N=31, $\lambda = 3.5$ gauss_legendre = 0.19397

N=35, $\lambda = 3.5$ gauss_legendre = 0.1914

N=27, $\lambda = 2.91$ gauss_legendre = 0.192801

N=27 $\lambda = 2.90$ gauss_legendre = 0.192725

---> dritbra

minker lambda s√• blir tilnermingen bedre

\begin{table}[h!]
  \caption{: Integration variying N Laguarre}
  \begin{tabular}{c c c}
    N & Laguerre & diff \\
    \hline
    10 & 0.177081 & 0.0156840 \\
    15 & 0.193285 & 0.000520  \\
    20 & 0.194786 & 0.002021  \\
    25 & 0.194804 & 0.002039  \\
    30 &  &  \\
  \end{tabular}
\end{table}


\begin{table}[h!]
  \caption{: Integration variying N Legendre}
  \begin{tabular}{c c c}
    N & Laguerre & diff \\
    \hline
    10 & 0.071980 & 0.120785 \\
    15 & 0.239088 & 0.046323 \\
    20 & 0.156139 & 0.036626 \\
    25 & 0.196817 & 0.003052 \\
    27 & &  \\
  \end{tabular}
\end{table}


\section*{Appendix}



\end{document}
